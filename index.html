<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Meu Universo X ‚Äî Shinobi Tech PRO</title>

<style>
:root{
  --bg:#071022;
  --panel:#071026;
  --accent:#00d4ff;
  --muted:rgba(255,255,255,0.08);
  --danger:#ff6b6b;
  --glass:rgba(255,255,255,0.03);
}

/* Reset */
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;background:var(--bg);color:#fff;font-family:Inter,Arial,system-ui;overflow:hidden}

/* --------------------------------------------------------------------- */
/* ‚óé PERGAMINHO NARUTO PRO ‚Äî CINEM√ÅTICO                                 */
/* --------------------------------------------------------------------- */

#scroll-screen{
  position:fixed;inset:0;
  display:flex;justify-content:center;align-items:center;
  background:radial-gradient(circle at 30% 20%, #062033 0%, #030612 65%);
  z-index:99999;overflow:hidden;
}

/* queda inicial */
.scroll-core{
  width:92%;max-width:820px;
  transform-origin:top;
  opacity:0;
  animation:dropIn .9s ease-out forwards;
}
@keyframes dropIn{
  0%{transform:translateY(-260px) scaleY(.3);opacity:0}
  60%{opacity:1}
  100%{transform:translateY(0) scaleY(1)}
}

/* extremidades de madeira */
.scroll-top,.scroll-bottom{
  height:56px;
  background:linear-gradient(90deg,#5c3412,#b5783f,#5c3412);
  border-radius:36px;
  box-shadow:0 16px 50px rgba(0,0,0,.6);
}

/* corpo do pergaminho */
.scroll-body{
  background:linear-gradient(180deg,#f6e9cf,#e8d5aa);
  box-shadow:inset 0 0 80px rgba(0,0,0,.18);
  padding:96px 48px;min-height:360px;
  transform-origin:top;transform:scaleY(0);
  animation:unroll 2.4s cubic-bezier(.15,.95,.25,1.15) .3s forwards;
}
@keyframes unroll{
  0%{transform:scaleY(0)}
  50%{transform:scaleY(1.2)}
  100%{transform:scaleY(1)}
}

/* fuma√ßa chakra sem ficheiros externos */
.scroll-smoke{
  position:absolute;left:50%;top:50%;
  width:900px;height:520px;pointer-events:none;
  transform:translate(-50%,-50%) scale(.5);
  opacity:0;mix-blend-mode:screen;
  background:
    radial-gradient(circle at 20% 20%, rgba(0,200,255,0.15) 0%, transparent 45%),
    radial-gradient(circle at 80% 30%, rgba(0,200,255,0.12) 0%, transparent 40%),
    radial-gradient(circle at 50% 70%, rgba(255,255,255,0.06) 0%, transparent 50%);
  filter:blur(12px) url(#goo);
  animation:smokeIn 2.2s ease-out 1.4s forwards;
}
@keyframes smokeIn{
  0%{opacity:0;transform:translate(-50%,-50%) scale(.4)}
  40%{opacity:.8}
  100%{opacity:0;transform:translate(-50%,-50%) scale(1.2)}
}

/* selo */
.scroll-seal{
  width:128px;height:128px;margin:0 auto 22px;
  display:flex;justify-content:center;align-items:center;
  border-radius:50%;
  background:radial-gradient(circle,#de3b3b,#7e0000);
  box-shadow:0 14px 40px rgba(217,59,59,.28);
  opacity:0;transform:scale(.3);
  animation:sealPop .7s cubic-bezier(.2,1.4,.3,1) 2.3s forwards;
}
@keyframes sealPop{
  0%{opacity:0;transform:scale(.3)}
  70%{opacity:1;transform:scale(1.25)}
  100%{transform:scale(1)}
}

/* caractere */
.scroll-seal-char{
  font-size:52px;color:#fff;font-weight:900;
  text-shadow:0 5px 15px rgba(0,0,0,.6)
}

/* t√≠tulo */
.scroll-title{
  text-align:center;font-size:50px;font-family:Georgia,serif;color:#7a4317;
  opacity:0;transform:translateY(28px);
  animation:titleIn 1.3s ease-out 2.9s forwards;
}
@keyframes titleIn{
  0%{opacity:0;transform:translateY(28px)}
  100%{opacity:1;transform:translateY(0)}
}

/* desaparecer  */
.fade-out-scroll{
  animation:scrollClose 2.5s ease forwards;
}
@keyframes scrollClose{
  0%{opacity:1;transform:translateY(0) scale(1)}
  80%{opacity:0.2;transform:translateY(-100px) scale(.7)}
  100%{opacity:0;transform:translateY(-160px) scale(.5)}
}

/* filtro goo */
</style>

<svg width="0" height="0" style="position:absolute">
  <filter id="goo">
    <feGaussianBlur in="SourceGraphic" stdDeviation="8" result="blur"/>
    <feColorMatrix in="blur" type="matrix"
      values="1 0 0 0 0
              0 1 0 0 0
              0 0 1 0 0
              0 0 0 18 -7"
      result="goo"/>
    <feBlend in="SourceGraphic" in2="goo"/>
  </filter>
</svg>
</head>
<body>

<!-- ========== PERGAMINHO ========== -->
<div id="scroll-screen">
  <div class="scroll-smoke"></div>
  <div class="scroll-core">
    <div class="scroll-top"></div>
      <div class="scroll-body">
        <div class="scroll-seal"><div class="scroll-seal-char">Â∞Å</div></div>
        <div class="scroll-title">MEU UNIVERSO X</div>
      </div>
    <div class="scroll-bottom"></div>
  </div>
</div>

<!-- ========== LOGIN ========== -->
<div id="login-screen" style="display:none">
  <div class="login-card">
    <h2>üîí Meu Universo X</h2>
    <p id="login-sub" class="small">Insere a senha para entrar.</p>

    <input id="pwd" class="input" type="password" placeholder="Senha" />
    <button id="btnLogin" class="btn">Entrar</button>

    <div style="display:flex;gap:8px;margin-top:12px;justify-content:center">
      <button id="btnSetPwd" class="btn-ghost">Alterar Senha</button>
      <button id="btnForgot" class="btn-ghost">Apagar Dados</button>
    </div>

    <div id="errLogin" class="err" style="display:none">Senha incorreta</div>
  </div>
</div>

<!-- ========== APP INTERFACE ========== -->
<div id="app" style="display:none">
  <div class="topbar">
    <div class="brand">
      <div class="logo">MX</div>
      <div>
        <div class="apptitle">Meu Universo X</div>
        <div class="small" style="opacity:.6">Shinobi Tech</div>
      </div>
    </div>

    <div class="top-actions">
      <input id="search" class="search" placeholder="Pesquisar..." />
      <button id="openSettings" class="btn-ghost">‚öôÔ∏è</button>
      <button id="logoutBtn" class="btn-ghost">üö™</button>
    </div>
  </div>

  <div class="container">
    <aside class="sidebar">
      <div class="side-title">Notas</div>
      <div class="menu-item active" data-tab="all">Todas</div>
      <div class="menu-item" data-tab="fav">Favoritas</div>
      <div class="menu-item" data-tab="arch">Arquivadas</div>

      <div style="height:20px"></div>
      <div class="side-title">Partilha</div>
      <div class="small" style="opacity:.7">WhatsApp ‚Ä¢ Telegram ‚Ä¢ X ‚Ä¢ Email ‚Ä¢ Copiar</div>
    </aside>

    <main class="main">
      <div class="controls">
        <button id="newNote" class="btn-ghost">+ Nova Nota</button>
        <div style="flex:1"></div>
        <div class="small">Notas: <span id="count">0</span></div>
      </div>
      <div id="grid" class="grid"></div>
    </main>
  </div>

  <div id="fab" class="fab">+</div>
</div>
<!-- ========== MODAL EDITOR ========== -->
<div id="modal" class="modal" style="display:none">
  <div class="modal-card">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <strong>Editor de Nota</strong>
      <button id="closeModal" class="btn-ghost">Fechar</button>
    </div>

    <input id="noteTitle" class="input" placeholder="T√≠tulo">
    <textarea id="noteContent" class="input mono" style="min-height:150px" placeholder="Conte√∫do..."></textarea>

    <div style="display:flex;gap:8px;margin-top:12px;flex-wrap:wrap">
      <button id="saveNote" class="btn">Salvar</button>
      <button id="toggleFav" class="btn-ghost">‚≠ê</button>
      <button id="archiveNote" class="btn-ghost">üì¶</button>
      <button id="delNote" class="btn-ghost" style="color:#ff6b6b">üóëÔ∏è</button>

      <div style="flex:1"></div>

      <button id="shareWhatsapp" class="btn-ghost">WhatsApp</button>
      <button id="shareTelegram" class="btn-ghost">Telegram</button>
      <button id="shareX" class="btn-ghost">X</button>
      <button id="shareEmail" class="btn-ghost">Email</button>
      <button id="copyText" class="btn-ghost">Copiar</button>
    </div>
  </div>
</div>

<!-- ========== CONFIGURA√á√ïES ========== -->
<div id="modal-settings" class="modal" style="display:none">
  <div class="modal-card">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <strong>Configura√ß√µes</strong>
      <button id="closeSettings" class="btn-ghost">Fechar</button>
    </div>

    <div class="small">Alterar senha</div>
    <input id="newPwd" class="input" type="password" placeholder="Nova senha" />
    <input id="newPwdConfirm" class="input" type="password" placeholder="Confirmar senha" />
    <div style="display:flex;gap:8px;margin-top:8px">
      <button id="savePwd" class="btn">Salvar senha</button>
      <button id="clearAll" class="btn-ghost" style="color:#ff6b6b">Apagar tudo</button>
      <div id="pwdMsg" class="small" style="margin-left:auto"></div>
    </div>

    <hr style="margin:14px 0;border:0;border-top:1px solid rgba(255,255,255,.06)">

    <div style="display:flex;gap:8px">
      <button id="exportData" class="btn-ghost">Exportar</button>
      <label class="btn-ghost" style="cursor:pointer">Importar
        <input id="importFile" type="file" accept="application/json" style="display:none">
      </label>
      <div id="importMsg" class="small" style="margin-left:auto"></div>
    </div>
  </div>
</div>

<!-- ========== JAVASCRIPT ========== -->
<script>
/* ------------------------------------------------ */
/* ‚óè ESTADO E LOCALSTORAGE                          */
/* ------------------------------------------------ */
const LS_KEY = "mx_universo_v3";
let state = loadState();
function loadState(){
  try{
    const raw = localStorage.getItem(LS_KEY);
    if(!raw) return {password:null,notes:[]};
    const data = JSON.parse(raw);
    if(!Array.isArray(data.notes)) data.notes = [];
    return data;
  }catch(e){return {password:null,notes:[]}}
}
function saveState(){localStorage.setItem(LS_KEY, JSON.stringify(state))}

/* ------------------------------------------------ */
/* ‚óè ELEMENTOS                                      */
/* ------------------------------------------------ */
const $ = id => document.getElementById(id);
const refs = {
  scroll: $("scroll-screen"),
  core: document.querySelector(".scroll-core"),
  smoke: document.querySelector(".scroll-smoke"),
  login: $("login-screen"),
  app: $("app"),
  pwd: $("pwd"),
  btnLogin: $("btnLogin"),
  btnSetPwd: $("btnSetPwd"),
  btnForgot: $("btnForgot"),
  errLogin: $("errLogin"),
  loginSub: $("login-sub"),
  newNote: $("newNote"),
  fab: $("fab"),
  grid: $("grid"),
  count: $("count"),
  search: $("search"),
  modal: $("modal"),
  modalSettings: $("modal-settings"),
  closeModal: $("closeModal"),
  closeSettings: $("closeSettings"),
  saveNote: $("saveNote"),
  noteTitle: $("noteTitle"),
  noteContent: $("noteContent"),
  delNote: $("delNote"),
  toggleFav: $("toggleFav"),
  archiveNote: $("archiveNote"),
  newPwd: $("newPwd"),
  newPwdConfirm: $("newPwdConfirm"),
  savePwd: $("savePwd"),
  pwdMsg: $("pwdMsg"),
  clearAll: $("clearAll"),
  exportData: $("exportData"),
  importFile: $("importFile"),
  importMsg: $("importMsg"),
  shareWhatsapp: $("shareWhatsapp"),
  shareTelegram: $("shareTelegram"),
  shareX: $("shareX"),
  shareEmail: $("shareEmail"),
  copyText: $("copyText"),
  openSettings: $("openSettings"),
  logoutBtn: $("logoutBtn"),
};
const tabs = document.querySelectorAll(".menu-item");

/* ------------------------------------------------ */
/* ‚óè ANIMA√á√ÉO DO PERGAMINHO                         */
/* ------------------------------------------------ */
setTimeout(()=>{

  // som jutsu
  playJutsuTone();
  // fuma√ßa aparece
  refs.smoke.style.opacity = "1";

  // espera 2s para fuma√ßa expandir
  setTimeout(()=>{

    // fecha pergaminho em 2.5s
    refs.core.classList.add("fade-out-scroll");

    setTimeout(()=>{
      refs.scroll.style.display = "none";
      showLogin();
    },2500);

  },2000);

},4500);

/* som jutsu via WebAudio (sem ficheiros) */
function playJutsuTone(){
  try{
    const ctx = new AudioContext();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.connect(g);g.connect(ctx.destination);
    o.type="sine";o.frequency.value=220;
    const now = ctx.currentTime;
    g.gain.setValueAtTime(0,now);
    g.gain.linearRampToValueAtTime(0.2,now+.05);
    o.frequency.exponentialRampToValueAtTime(880,now+.3);
    g.gain.exponentialRampToValueAtTime(.0001,now+1.3);
    o.start(now);o.stop(now+1.5);
  }catch(e){}
}

/* ------------------------------------------------ */
/* ‚óè LOGIN                                          */
/* ------------------------------------------------ */
function showLogin(){
  refs.login.style.display="flex";
  updateLoginSubtitle();
}
function updateLoginSubtitle(){ refs.loginSub.textContent = state.password ? "Insere a senha para entrar." : "Define uma senha." }

refs.btnLogin.onclick = ()=> tryLogin();
refs.pwd.onkeypress = e=>{ if(e.key==="Enter") tryLogin(); };
function tryLogin(){
  if(!state.password){ showSettings(); return; }
  if(refs.pwd.value===state.password){
    refs.login.style.display="none";
    refs.app.style.display="block";
    renderNotes();
  } else {
    showLoginError("Senha incorreta");
  }
}
function showLoginError(msg){
  refs.errLogin.textContent=msg;
  refs.errLogin.style.display="block";
  setTimeout(()=>refs.errLogin.style.display="none",1500);
}

/* ------------------------------------------------ */
/* ‚óè SENHA E DEFINI√á√ïES                              */
/* ------------------------------------------------ */
refs.openSettings.onclick = showSettings;
refs.btnSetPwd.onclick = showSettings;
refs.closeSettings.onclick = ()=> refs.modalSettings.style.display="none";
function showSettings(){ refs.modalSettings.style.display="flex"; }

refs.savePwd.onclick = ()=>{
  const a = refs.newPwd.value.trim();
  const b = refs.newPwdConfirm.value.trim();
  if(!a){ refs.pwdMsg.textContent="Senha vazia";return; }
  if(a!==b){ refs.pwdMsg.textContent="N√£o coincide";return; }
  state.password=a; saveState();
  refs.pwdMsg.textContent="Salva!";
  setTimeout(()=> refs.modalSettings.style.display="none",800);
};

refs.clearAll.onclick = ()=>{
  if(confirm("Apagar todas as notas e senha?")){
    state={password:null,notes:[]}; saveState();
    alert("Dados apagados!");
    location.reload();
  }
};

/* EXPORTAR / IMPORTAR */
refs.exportData.onclick=()=>{
  const blob=new Blob([JSON.stringify(state,null,2)],{type:"application/json"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url;a.download="universo_backup.json";a.click();
  URL.revokeObjectURL(url);
};
refs.importFile.onchange=(e)=>{
  const f=e.target.files[0]; if(!f) return;
  const r=new FileReader();
  r.onload=()=>{
    try{
      const j=JSON.parse(r.result);
      state=j; saveState();
      refs.importMsg.textContent="Importado!";
      setTimeout(()=>location.reload(),800);
    }catch(err){ refs.importMsg.textContent="Erro no JSON"; }
  };
  r.readAsText(f);
};

/* ------------------------------------------------ */
/* ‚óè NOTAS                                          */
/* ------------------------------------------------ */
let current = null;

refs.newNote.onclick = ()=> openEditor(null);
refs.fab.onclick = ()=> openEditor(null);
refs.closeModal.onclick = ()=> refs.modal.style.display="none";

function openEditor(id){
  current=id;
  if(id){
    const n=state.notes.find(x=>x.id===id);
    refs.noteTitle.value=n.title;
    refs.noteContent.value=n.content;
  } else {
    refs.noteTitle.value="";
    refs.noteContent.value="";
  }
  refs.modal.style.display="flex";
}

refs.saveNote.onclick = ()=>{
  const t=refs.noteTitle.value.trim();
  const c=refs.noteContent.value.trim();
  if(current){
    const n=state.notes.find(x=>x.id===current);
    n.title=t;n.content=c;n.updated=Date.now();
  } else {
    state.notes.push({id:Date.now(),title:t,content:c,created:Date.now(),updated:Date.now(),fav:false,arch:false});
  }
  saveState();
  refs.modal.style.display="none";
  renderNotes();
};

refs.delNote.onclick = ()=>{
  if(current){
    state.notes=state.notes.filter(n=>n.id!==current);
    saveState();
    refs.modal.style.display="none";
    renderNotes();
  }
};

refs.toggleFav.onclick = ()=>{
  if(current){
    const n=state.notes.find(x=>x.id===current);
    n.fav=!n.fav;saveState();renderNotes();
  }
};

refs.archiveNote.onclick = ()=>{
  if(current){
    const n=state.notes.find(x=>x.id===current);
    n.arch=!n.arch;saveState();renderNotes();
  }
};

/* Renderiza√ß√£o */
function renderNotes(){
  refs.grid.innerHTML="";
  const tab=getTab();
  let arr=[...state.notes].reverse();
  if(tab==="fav") arr=arr.filter(n=>n.fav && !n.arch);
  if(tab==="arch") arr=arr.filter(n=>n.arch);
  arr.forEach(n=>{
    const card=document.createElement("div");
    card.className="note";
    card.innerHTML=`
      <h4>${escape(n.title)||"Sem t√≠tulo"}</h4>
      <p>${escape(n.content)}</p>
      <div class="meta"><span>${new Date(n.created).toLocaleString()}</span><span>${n.fav?"‚≠ê":""}${n.arch?" ‚Ä¢ arquivada":""}</span></div>
    `;
    card.onclick=()=>openEditor(n.id);
    refs.grid.appendChild(card);
  });
  refs.count.textContent=state.notes.length;
}

function escape(t=""){
  return t.replaceAll("<","&lt;").replaceAll(">","&gt;");
}

tabs.forEach(t=>t.onclick=()=>{
  tabs.forEach(x=>x.classList.remove("active"));
  t.classList.add("active");
  renderNotes();
});
function getTab(){return document.querySelector(".menu-item.active").dataset.tab;}

refs.search.oninput = ()=> {
  const q=refs.search.value.toLowerCase();
  const cards=[...document.querySelectorAll(".note")];
  cards.forEach(c=>{
    const text=c.innerText.toLowerCase();
    c.style.display=text.includes(q)?"block":"none";
  });
};

/* ------------------------------------------------ */
/* ‚óè PARTILHAR TEXTO                                */
/* ------------------------------------------------ */
function getShare(){
  const t=refs.noteTitle.value;
  const c=refs.noteContent.value;
  return t+"\n\n"+c;
}

refs.shareWhatsapp.onclick = ()=> window.open("https://api.whatsapp.com/send?text="+encodeURIComponent(getShare()));
refs.shareTelegram.onclick = ()=> window.open("https://t.me/share/url?text="+encodeURIComponent(getShare()));
refs.shareX.onclick = ()=> window.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(getShare()));
refs.shareEmail.onclick = ()=> location.href="mailto:?subject="+encodeURIComponent(refs.noteTitle.value)+"&body="+encodeURIComponent(getShare());
refs.copyText.onclick = ()=> {navigator.clipboard.writeText(getShare()); alert("Copiado!");};

/* ------------------------------------------------ */
/* ‚óè LOGOUT                                         */
/* ------------------------------------------------ */
refs.logoutBtn.onclick = ()=> {
  refs.app.style.display="none";
  refs.login.style.display="flex";
  refs.pwd.value="";
};
</script>
</body>
</html>
